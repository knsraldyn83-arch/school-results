<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>منصة مدارس كفاح البروف – نتائج الطلاب</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

<meta name="description" content="منصة مدارس كفاح البروف للاستعلام عن نتائج الطلاب باستخدام رقم الجلوس.">
<meta name="keywords" content="نتائج الطلاب, نتائج الامتحانات, مدارس كفاح البروف, نتائج السودان">
<meta name="author" content="منصة مدارس كفاح البروف">
<meta name="robots" content="index, follow">

<style>
*{
box-sizing:border-box;
}

body{
font-family:Tahoma, Arial;
background:#f2f2f2;
margin:0;
padding:0;
font-size:16px;
}

.container,.intro{
width:95%;
max-width:500px;
margin:15px auto;
background:#fff;
padding:15px;
border-radius:10px;
box-shadow:0 2px 8px rgba(0,0,0,0.15);
}

h1{
font-size:22px;
margin:5px 0;
}

h2{
font-size:18px;
margin:10px 0;
}

p{
font-size:15px;
text-align:center;
}

input,button{
width:100%;
padding:12px;
margin:6px 0;
font-size:16px;
border-radius:8px;
}

input{
border:1px solid #ccc;
}

button{
background:#007bff;
color:#fff;
border:none;
cursor:pointer;
}

button:hover{
background:#0056b3;
}

.back-btn{
background:#6c757d;
}

.hidden{
display:none;
}

.result{
background:#e9ffe9;
padding:12px;
border-radius:8px;
margin-top:10px;
font-size:15px;
line-height:1.6;
}

/* تحسين إضافي للشاشات الصغيرة جدًا */
@media (max-width:360px){
h1{font-size:20px}
h2{font-size:17px}
input,button{font-size:15px;padding:10px}
}
</style>
</head>

<body>

<div class="intro">
<h1>منصة مدارس كفاح البروف</h1>
<p>منصة إلكترونية للاستعلام عن نتائج الطلاب</p>
</div>

<div class="container" id="home">
<h2>نظام النتائج المدرسية</h2>
<button onclick="showTeacher()">واجهة المعلم</button>
<button onclick="showStudent()">واجهة الطالب</button>
<button onclick="showChangePass()">تغيير كلمة السر</button>
</div>

<div class="container hidden" id="teacher">
<button class="back-btn" onclick="back()">⬅ رجوع</button>
<h2>واجهة المعلم</h2>
<input type="password" id="pin" placeholder="أدخل كلمة السر">
<button onclick="unlock()">دخول</button>

<div id="teacherPanel" class="hidden">
<input id="t_name" placeholder="اسم الطالب">
<input id="t_seat" placeholder="رقم الجلوس">
<input id="t_result" placeholder="النتيجة">
<input id="t_exam" placeholder="نوع الامتحان (اختياري)">
<input id="t_note" placeholder="ملاحظة (اختياري)">
<button onclick="saveResult()">حفظ النتيجة</button>
<button onclick="clearDatabase()">مسح كل البيانات</button>
</div>
</div>

<div class="container hidden" id="student">
<button class="back-btn" onclick="back()">⬅ رجوع</button>
<h2>واجهة الطالب</h2>
<input id="s_seat" placeholder="رقم الجلوس">
<button onclick="getResult()">عرض النتيجة</button>
<div id="output"></div>
</div>

<div class="container hidden" id="changePass">
<button class="back-btn" onclick="back()">⬅ رجوع</button>
<h2>تغيير كلمة السر</h2>
<input type="password" id="oldPass" placeholder="كلمة السر القديمة">
<input type="password" id="newPass" placeholder="كلمة السر الجديدة">
<button onclick="changePassword()">حفظ التغيير</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
apiKey: "AIzaSyAImNyFTMVJc_aYR4zh9RKUgEVPS_2l2q4",
databaseURL: "https://school-results-36615-default-rtdb.firebaseio.com",
projectId: "school-results-36615"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let currentPassword = "2006";

db.ref("admin/password").once("value").then(s=>{
if(s.exists()) currentPassword = s.val();
});

function hideAll(){
document.querySelectorAll('.container').forEach(c=>c.classList.add('hidden'));
}

function showTeacher(){hideAll();teacher.classList.remove('hidden')}
function showStudent(){hideAll();student.classList.remove('hidden')}
function showChangePass(){hideAll();changePass.classList.remove('hidden')}
function back(){hideAll();home.classList.remove('hidden')}

function unlock(){
pin.value===currentPassword ?
teacherPanel.classList.remove('hidden') :
alert("كلمة السر غير صحيحة");
}

function changePassword(){
if(oldPass.value!==currentPassword) return alert("كلمة السر القديمة خاطئة");
if(newPass.value.length<4) return alert("كلمة السر ضعيفة");

db.ref("admin/password").set(newPass.value).then(()=>{
currentPassword=newPass.value;
oldPass.value=newPass.value="";
alert("تم تغيير كلمة السر");
});
}

function saveResult(){
if(!t_name.value||!t_seat.value||!t_result.value)
return alert("املأ الحقول الأساسية");

db.ref("students/"+t_seat.value).set({
name:t_name.value,
result:t_result.value,
exam:t_exam.value,
note:t_note.value
}).then(()=>{
t_name.value=t_seat.value=t_result.value=t_exam.value=t_note.value="";
alert("تم الحفظ");
});
}

function getResult(){
if(!s_seat.value)return;
db.ref("students/"+s_seat.value).once("value").then(s=>{
output.innerHTML=s.exists()?`
<div class="result">
الاسم: ${s.val().name}<br>
النتيجة: ${s.val().result}<br>
نوع الامتحان: ${s.val().exam||'-'}<br>
ملاحظة: ${s.val().note||'-'}
</div>`:"لا توجد نتيجة";
});
}

function clearDatabase(){
if(confirm("هل أنت متأكد؟"))
db.ref("students").remove();
}
</script>

</body>
</html>