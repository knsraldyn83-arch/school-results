<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>نظام النتائج المدرسية</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f2f2;
  direction: rtl;
  text-align: center;
}

.container {
  background: #fff;
  padding: 20px;
  margin: 20px auto;
  width: 95%;
  max-width: 800px;
  border-radius: 10px;
  box-shadow: 0 0 10px #ccc;
}

input, button {
  padding: 8px;
  margin: 5px;
}

button {
  background: #007bff;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

button:hover {
  background: #0056b3;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}

th, td {
  border: 1px solid #ccc;
  padding: 8px;
}
</style>
</head>

<body>

<div class="container">
  <h2>نظام النتائج المدرسية</h2>

  <!-- إضافة طالب واحد -->
  <h3>إضافة طالب</h3>
  <input id="name" placeholder="اسم الطالب">
  <input id="number" placeholder="رقم الجلوس">
  <input id="grade" placeholder="النتيجة">
  <button onclick="addStudent()">إضافة</button>

  <hr>

  <!-- إضافة جماعية -->
  <h3>إضافة عدة طلاب (CSV)</h3>
  <input type="file" id="fileInput" accept=".csv">
  <button onclick="importCSV()">إضافة من ملف</button>

  <hr>

  <!-- جدول -->
  <table>
    <thead>
      <tr>
        <th>الاسم</th>
        <th>رقم الجلوس</th>
        <th>النتيجة</th>
        <th>تعديل</th>
        <th>حذف</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>

<script>
let students = JSON.parse(localStorage.getItem("students")) || [];

function save() {
  localStorage.setItem("students", JSON.stringify(students));
}

function render() {
  const tbody = document.getElementById("tableBody");
  tbody.innerHTML = "";
  students.forEach((s, i) => {
    tbody.innerHTML += `
      <tr>
        <td>${s.name}</td>
        <td>${s.number}</td>
        <td>${s.grade}</td>
        <td><button onclick="editStudent(${i})">تعديل</button></td>
        <td><button onclick="deleteStudent(${i})">حذف</button></td>
      </tr>
    `;
  });
}

function addStudent() {
  let name = document.getElementById("name").value;
  let number = document.getElementById("number").value;
  let grade = document.getElementById("grade").value;

  if (!name || !number || !grade) {
    alert("أدخل كل البيانات");
    return;
  }

  students.push({ name, number, grade });
  save();
  render();

  document.getElementById("name").value = "";
  document.getElementById("number").value = "";
  document.getElementById("grade").value = "";
}

function editStudent(i) {
  let name = prompt("تعديل الاسم", students[i].name);
  let number = prompt("تعديل رقم الجلوس", students[i].number);
  let grade = prompt("تعديل النتيجة", students[i].grade);

  if (name && number && grade) {
    students[i] = { name, number, grade };
    save();
    render();
  }
}

function deleteStudent(i) {
  if (confirm("هل تريد الحذف؟")) {
    students.splice(i, 1);
    save();
    render();
  }
}

function importCSV() {
  const file = document.getElementById("fileInput").files[0];
  if (!file) return alert("اختر ملف CSV");

  const reader = new FileReader();
  reader.onload = e => {
    const lines = e.target.result.split("\n");
    for (let i = 1; i < lines.length; i++) {
      let [name, number, grade] = lines[i].split(",");
      if (name && number && grade) {
        students.push({
          name: name.trim(),
          number: number.trim(),
          grade: grade.trim()
        });
      }
    }
    save();
    render();
  };
  reader.readAsText(file);
}

render();
</script>

</body>
</html>